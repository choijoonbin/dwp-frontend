ğŸ­ DWP Frontend Unified Enterprise Rules (v1.5)

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸŒŒ Project Identity & Architecture
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
- Core: React 18+, TypeScript (Strict Mode í•„ìˆ˜)
- Structure: Nx Monorepo ê¸°ë°˜ Micro Frontend ì•„í‚¤í…ì²˜
- MFE Runtime:
  - í˜„ì¬ëŠ” Vite ê¸°ë°˜ Host/Remote ë¡œë”© êµ¬ì¡°ë¥¼ ì‚¬ìš©í•œë‹¤.
  - Webpack Module Federationì€ ë„ì… ì˜ˆì •ì´ê±°ë‚˜, ì ìš© ì‹œ ë²”ìœ„ë¥¼ ëª…í™•íˆ ë¬¸ì„œë¡œ ê³ ì§€í•´ì•¼ í•œë‹¤.
- Host (apps/dwp):
  - ì‹œìŠ¤í…œì˜ Shell ì—­í• 
  - Sidebar, Header, Auth(ì¸ì¦/ì¸ê°€), Tenant ì‹ë³„, Global Policy ë‹¨ì¼ ì†Œìœ 
- Remote (apps/remotes/*):
  - ê°œë³„ ë¹„ì¦ˆë‹ˆìŠ¤ ëª¨ë“ˆ
  - âŒ ìì²´ Header / Sidebar / Global Layout ì¤‘ë³µ êµ¬í˜„ ì ˆëŒ€ ê¸ˆì§€
  - Hostê°€ ì œê³µí•˜ëŠ” Layout/Theme/Auth ì •ì±…ì„ ë°˜ë“œì‹œ ë”°ë¥¸ë‹¤
- Lib Ownership:
  - ê³µí†µ UI: libs/design-system
  - ê³µí†µ ë¹„ì¦ˆë‹ˆìŠ¤/ì¸ì¦/ê¶Œí•œ/ìœ í‹¸: libs/shared-utils
âœ… React Version Policy (Latest Only)
- Core ReactëŠ” ë°˜ë“œì‹œ ìµœì‹  Stable Majorë¥¼ ì‚¬ìš©í•œë‹¤.
  - React: ^19.x
  - React-DOM: ^19.x
- ì‹ ê·œ ê°œë°œ ë° ê³µí†µ ì»´í¬ë„ŒíŠ¸ëŠ” React 19 ê¸°ì¤€ìœ¼ë¡œ ì‘ì„±í•œë‹¤.
- React 18 fallback / polyfill ì „ì œì˜ ì½”ë“œëŠ” ê¸ˆì§€í•œë‹¤.
- package.json ì˜ì¡´ì„±ì—ì„œ react/react-dom ë²„ì „ì´ 18ë¡œ ë‚´ë ¤ê°€ë©´ PR Reject ì²˜ë¦¬í•œë‹¤.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ›  UI / UX & Responsive Standard
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
- UI Library: MUI v5 ONLY
  âŒ shadcn/ui, Radix UI, AntD, Chakra ë“± íƒ€ UI ë¼ì´ë¸ŒëŸ¬ë¦¬ ì‚¬ìš© ê¸ˆì§€
- Styling:
  - MUI System(sx, styled) + Emotion ì‚¬ìš©
  - TailwindëŠ” ë ˆì´ì•„ì›ƒ ë³´ì¡°ìš©ìœ¼ë¡œë§Œ ì œí•œì  í—ˆìš©
- Icons:
  - Iconify (@iconify/react) ONLY
  âŒ Lucide, Heroicons, MUI Icons ì§ì ‘ ì‚¬ìš© ê¸ˆì§€
- Theme:
  - Hostì˜ ThemeProviderë¥¼ ëª¨ë“  Remoteê°€ ìƒì†
  - Dark / Light Mode ì‹¤ì‹œê°„ ë™ê¸°í™” í•„ìˆ˜
- Responsive:
  - Mobile-First ì „ëµ ì¤€ìˆ˜
  - MUI breakpoint(xs, sm, md) ê¸°ì¤€ ì‚¬ìš©
- Hybrid Bridge:
  - í•˜ì´ë¸Œë¦¬ë“œ ì•±(WebView) ëŒ€ì‘ì„ ìœ„í•´
    window.ReactNativeWebView ë“± ë„¤ì´í‹°ë¸Œ í†µì‹  ì¸í„°í˜ì´ìŠ¤ëŠ”
    ë°˜ë“œì‹œ libs/shared-utilsì— ì¶”ìƒí™”í•˜ì—¬ êµ¬í˜„

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ§­ Navigation & Menu (RBAC + Menu Tree Contract)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
- Sidebar Menu Source of Truth:
  - Sidebar ë©”ë‰´ íŠ¸ë¦¬ëŠ” ë°˜ë“œì‹œ ë°±ì—”ë“œì˜ Menu Tree APIë¥¼ ê¸°ì¤€ìœ¼ë¡œ ë Œë”ë§í•œë‹¤.
  - âœ… í‘œì¤€ API: GET /api/auth/menus/tree
  - âŒ í”„ë¡ íŠ¸ì—ì„œ menu.* dotted keyë¥¼ íŒŒì‹±í•˜ì—¬ íŠ¸ë¦¬ë¥¼ "ì¶”ë¡ "í•˜ëŠ” ë°©ì‹ì€ ì„ì‹œ Hotfix ì™¸ ê¸ˆì§€í•œë‹¤.
- Menu Tree Rendering Rules:
  - ì‘ë‹µìœ¼ë¡œ ë°›ì€ children íŠ¸ë¦¬ë¥¼ ê·¸ëŒ€ë¡œ Sidebarì—ì„œ ê³„ì¸µ ë Œë”ë§í•œë‹¤.
  - ì •ë ¬ì€ sortOrder ì˜¤ë¦„ì°¨ìˆœì„ ê¸°ë³¸ìœ¼ë¡œ í•œë‹¤.
  - ë¶€ëª¨ ë©”ë‰´ê°€ pathê°€ ì—†ì„ ê²½ìš°:
    - ê¸°ë³¸ ì •ì±…: ì²« ë²ˆì§¸ í—ˆìš© childì˜ pathë¡œ fallback ì´ë™ì„ ì§€ì›í•œë‹¤.
- Permission Responsibility Split:
  - Sidebar ë…¸ì¶œ: menus/tree API ê¸°ë°˜ (ì´ë¯¸ ê¶Œí•œ í•„í„°ê°€ ë°˜ì˜ëœ íŠ¸ë¦¬)
  - ë²„íŠ¼/ì»´í¬ë„ŒíŠ¸ ì œì–´: /api/auth/permissions ê¸°ë°˜(UI_COMPONENT ë“±)
- Route Protection:
  - Sidebarì—ì„œ ìˆ¨ê²¨ì ¸ë„ ì§ì ‘ URL ì ‘ê·¼ì€ ê°€ëŠ¥í•˜ë¯€ë¡œ
    ëª¨ë“  ë³´í˜¸ ë¼ìš°íŠ¸ëŠ” PermissionRouteGuard/AuthGuardë¡œ ì´ì¤‘ ë°©ì–´í•œë‹¤.
- Menu Keys & Resource Keys:
  - menuKey / resourceKeyëŠ” ë°˜ë“œì‹œ ìœ ì¼í•˜ë©°, ë°±ì—”ë“œ sys_menus.menu_keyì™€ ì¼ì¹˜í•´ì•¼ í•œë‹¤.
  - í”„ë¡ íŠ¸ì—ì„œ í•˜ë“œì½”ë”©ëœ ë©”ë‰´ keyëŠ” ìµœì†Œí™”í•˜ë©°, í•„ìš”í•œ ê²½ìš° docsì— ê·¼ê±°ë¥¼ ë‚¨ê¸´ë‹¤.

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ§  Agentic AI Integration (Aura Rules)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
- Streaming:
  - fetch + ReadableStream ê¸°ë°˜ SSE ì‚¬ìš©
  - polling / websocket ì„ì˜ ë„ì… ê¸ˆì§€
- Thought Trace:
  - ì¶”ë¡  ê³¼ì •(Thought)ê³¼ ìµœì¢… ê²°ê³¼(Result)ë¥¼ ì‹œê°ì ìœ¼ë¡œ ë¶„ë¦¬
- Mobile AI UX:
  - Mini Chat Overlay â†’ ëª¨ë°”ì¼ì—ì„œëŠ” Bottom Sheet í˜•íƒœ
  - Full AI Workspace â†’ ëª¨ë°”ì¼ì—ì„œëŠ” Tab UIë¡œ ë¶„ë¦¬
  - ëª¨ë“  í„°ì¹˜ íƒ€ê²Ÿ ìµœì†Œ 44x44px ë³´ì¥
- HITL (Human-in-the-loop):
  - ìŠ¹ì¸ ìš”ì²­ì€ ì „ìš© Modal ë˜ëŠ” Notificationìœ¼ë¡œ ëª…í™•íˆ í‘œì‹œ
  - ì‚¬ìš©ì ìŠ¹ì¸/ê±°ì ˆ í›„ì—ë§Œ ìŠ¤íŠ¸ë¦¬ë° ì¬ê°œ
- Context Awareness:
  - ì§ˆë¬¸ ì‹œ ë°˜ë“œì‹œ ì•„ë˜ ì»¨í…ìŠ¤íŠ¸ ìë™ í¬í•¨
    - tenantId
    - userId
    - appId
    - current route / selection
- SSE Event Contract:
  - ëª¨ë“  SSE ì´ë²¤íŠ¸ íƒ€ì…ì€
    libs/shared-utils/src/agent/events.ts (ë˜ëŠ” ë™ë“± ìœ„ì¹˜)ì—
    union typeìœ¼ë¡œ ëª…í™•íˆ ì •ì˜í•œë‹¤
  - UIëŠ” ì´ë²¤íŠ¸ë¥¼ ì§ì ‘ í•´ì„í•˜ì§€ ë§ê³  reducer/handlerë¥¼ í†µí•´ì„œë§Œ ë°˜ì˜
  - unknown ì´ë²¤íŠ¸ëŠ” ë¬´ì‹œ + ë¡œê·¸ ì²˜ë¦¬

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“œ Development & Coding Standards
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
- Component:
  - ëª¨ë“  ì»´í¬ë„ŒíŠ¸ëŠ” í™”ì‚´í‘œ í•¨ìˆ˜ ì‚¬ìš©
    `export const Component = () => {}`
- Logic Separation:
  - UI ì»´í¬ë„ŒíŠ¸ ë‚´ ë³µì¡í•œ ë¡œì§ ê¸ˆì§€
  - ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì€ Custom Hook ë˜ëŠ” libsë¡œ ë¶„ë¦¬
- State Management:
  - ì „ì—­ UI ìƒíƒœ: Zustand
  - ì„œë²„ ë°ì´í„°: TanStack Query
- TanStack Query Rules:
  - queryKeyëŠ” ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ê¸°ë°˜ìœ¼ë¡œ ì •ì˜
    (ì˜ˆ: mail.list(filters))
  - API í˜¸ì¶œì€ ì•„ë˜ ê³„ì¸µì„ ë°˜ë“œì‹œ ë”°ë¥¸ë‹¤:
    shared-utils/api â†’ shared-utils/queries â†’ pages/components
- API Client:
  - libs/shared-utilsì˜ axiosInstance(fetch wrapper) í•„ìˆ˜ ì‚¬ìš©
  - ApiResponse<T> ê·œê²© ì¤€ìˆ˜

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ”’ Authentication / Authorization / Security
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
- Unified Auth Ownership:
  - ì¸ì¦(Auth), 401/403 ì •ì±…ì€ Hostê°€ ë‹¨ì¼ ì†Œìœ 
  - RemoteëŠ” ë…ìì ì¸ ì¸ì¦ íë¦„ì„ êµ¬í˜„í•˜ì§€ ì•ŠëŠ”ë‹¤
- Auth Guard:
  - ëª¨ë“  ë³´í˜¸ ë¼ìš°íŠ¸ëŠ” AuthGuard í•„ìˆ˜ ì ìš©
- Permission Guard:
  - ê¶Œí•œ ê¸°ë°˜ ì ‘ê·¼ ì œì–´ëŠ” PermissionRouteGuardë¥¼ í‘œì¤€ìœ¼ë¡œ ì‚¬ìš©í•œë‹¤.
  - Sidebar ìˆ¨ê¹€ë§Œìœ¼ë¡œ ë³´ì•ˆì´ ì„±ë¦½í•œë‹¤ê³  ê°€ì •í•˜ì§€ ì•ŠëŠ”ë‹¤.
- Unauthorized Policy:
  - 401:
    - refresh ë¡œì§ì´ ìˆìœ¼ë©´ 1íšŒ ì‹œë„ ê°€ëŠ¥
    - ì‹¤íŒ¨ ì‹œ logout + /sign-in?returnUrl=... ë¦¬ë‹¤ì´ë ‰íŠ¸
    - âŒ ë¬´í•œ ë¦¬ë‹¤ì´ë ‰íŠ¸ ë£¨í”„ ì ˆëŒ€ ê¸ˆì§€
  - 403:
    - logout ê¸ˆì§€
    - ì ‘ê·¼ ê±°ë¶€ UX(/403 í˜ì´ì§€ ë˜ëŠ” í† ìŠ¤íŠ¸)ë¡œ ì²˜ë¦¬
- Redirect Security:
  - returnUrlì€ same-origin ë‚´ë¶€ ê²½ë¡œë§Œ í—ˆìš©
  - http://, https://, // ë¡œ ì‹œì‘í•˜ëŠ” ê°’ì€ ë¬´ì‹œ
- Multi-tenancy:
  - Tenant IDëŠ” ì„œë¸Œë„ë©”ì¸ ê¸°ë°˜ ì¶”ì¶œ
  - ì „ìš© ìœ í‹¸ë¦¬í‹°ë¥¼ í†µí•´ì„œë§Œ ì ‘ê·¼
- Unified Session:
  - SSO / ì¼ë°˜ ë¡œê·¸ì¸ ëª¨ë‘ ë™ì¼ JWT ëª¨ë¸ ì‚¬ìš©
- Header Policy:
  - X-Tenant-ID, X-User-ID, X-Agent-ID í—¤ë” ìë™ ì£¼ì… ê·œì¹™ í›¼ì† ê¸ˆì§€

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ§ª Testing & Quality Gate
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
- Unit Test:
  - libs/shared-utilsì˜ ìˆœìˆ˜ ë¡œì§ì€ Vitest í…ŒìŠ¤íŠ¸ í•„ìˆ˜
  - Auth redirect, token storage, SSE reducerëŠ” ìµœì†Œ í…ŒìŠ¤íŠ¸ ìš”êµ¬
  - âœ… menus/treeë¥¼ storeì— ë°˜ì˜í•˜ëŠ” ë¡œì§, fallback ì´ë™ ë¡œì§ì€ ìµœì†Œ í…ŒìŠ¤íŠ¸ ì¶”ê°€ ê¶Œì¥
- Integration:
  - MSW ê¸°ë°˜ API mocking ê¶Œì¥
- E2E (ê¶Œì¥):
  - Playwrightë¡œ Host + Remote í•µì‹¬ í”Œë¡œìš° ê²€ì¦
- PR Rule:
  - ë³€ê²½ëœ ë¡œì§ì— ëŒ€ì‘ë˜ëŠ” í…ŒìŠ¤íŠ¸ ì—†ì´ ë¨¸ì§€ ê¸ˆì§€

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
âš ï¸ Hard Rules (Strictly Prohibited)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
âŒ No Any:
- any íƒ€ì… ì‚¬ìš© ì ˆëŒ€ ê¸ˆì§€
- ë¶ˆê°€í”¼í•  ê²½ìš° unknown + type guard ì‚¬ìš©

âŒ Direct Import:
- Host â†” Remote ê°„ ìƒëŒ€ ê²½ë¡œ import ì ˆëŒ€ ê¸ˆì§€
- ê³µí†µ ì½”ë“œëŠ” ë°˜ë“œì‹œ libsë¥¼ í†µí•´ì„œë§Œ ê³µìœ 

âŒ Duplicate Layout:
- Remote ë‚´ë¶€ì—ì„œ Header / Sidebar / Global Layout ì¤‘ë³µ êµ¬í˜„ ê¸ˆì§€

âŒ MFE Expose Standard:
- ëª¨ë“  RemoteëŠ” src/remote-entry.tsë¥¼ í†µí•´ì„œë§Œ ê¸°ëŠ¥ ë…¸ì¶œ
- ë©”ì¸ ì»´í¬ë„ŒíŠ¸ ëª…ì€ ë°˜ë“œì‹œ Moduleë¡œ í†µì¼

âŒ Zustand Store Isolation:
- RemoteëŠ” Hostì˜ storeë¥¼ ì§ì ‘ ìˆ˜ì •í•  ìˆ˜ ì—†ë‹¤
- Hostê°€ ì „ë‹¬í•œ action / interfaceë¥¼ í†µí•´ì„œë§Œ ìƒí˜¸ì‘ìš©

âŒ Menu Tree Policy Violation:
- /api/auth/menus/treeê°€ ì¡´ì¬í•˜ëŠ” í™˜ê²½ì—ì„œ
  dotted key íŒŒì‹±ìœ¼ë¡œ ë©”ë‰´ íŠ¸ë¦¬ë¥¼ ì„ì˜ êµ¬ì„±í•˜ëŠ” ë°©ì‹ì€ ê¸ˆì§€
- Menu Registry(ì •ì  í•˜ë“œì½”ë”©)ë¡œ ì „ì²´ ë©”ë‰´ë¥¼ ê³ ì •í•˜ëŠ” ë°©ì‹ ê¸ˆì§€
  (ë‹¨, ì„ì‹œ fallback ë˜ëŠ” ê°œë°œ ë‹¨ê³„ì˜ ìµœì†Œ êµ¬ì„±ì€ í—ˆìš©)
